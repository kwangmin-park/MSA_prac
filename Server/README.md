#MSA

> 참고
>> https://yesesyo.medium.com/%EA%B0%80%EB%B3%8D%EA%B2%8C-%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B5%AC%EC%B6%95%ED%95%B4%EB%B3%B4%EA%B8%B0-2-6b417aedaec

> 모놀리식 아키텍처(여러 서비스를 하나의 WAS에 배포 운영할 때)의 단점
>> 1. 비효율적인 배포 : 특정 하나의 서비스를 수정하더라도 전체 애플리케이션을 컴파일 -> 배포해야한다
>> 2. 서비스 간의 장애 전파 : 하나의 서비스에서의 장애가 다른 서비스에 전파될 가능성이 높다
>> 3. 비효율적인 하드웨어 자원 활용 : 각 컴포넌트 별로 요구되는 하드웨어 리소스가 다름에도 불구하고 하나의 애플리케이션으로 패키징되어 있어 하드웨어 리소스를 컴팩트하게 할당하기 어려움
>> 4. 새로운 기술스택 도입의 어려움 : 부분적으로 새로운 기술스택(언어, 라이브러리, 프레임워크, DBMS 등)을 적용하기 어려움

> MSA 단점
>> 1. 성능 이슈 : 서로 독립적인 서비스로 분리된 컴포넌트들은 API 통신을 통해 데이터를 주고받아야하므로 성능 저하 발생 가능성
>> 2. 트랜잭션 관리 어려움 : 서로 독립적인 서비스로 분리된 컴포넌트 간의 발생한 트랜잭션 관리 어려움
>> 3. 데이터 무결성 보장의 어려움 : 서비스 단위로 분리된 데이터 레이어 간의 역정규화(Denormalization)를 하게 될 경우 해당 데이터에 대한 무결성 보장의 어려움

> MSA 필수 구성
>> 1. Service Descovery : 각 서비스들의 네트워크 위치 정보(IP, Port)를 저장 및 관리. 특히 클라우드와 같이 각 서비스의 네트워크 정보가 동적으로 바뀔 수 있는 환경에서 필수적
>> 2. API Gateway : 서비스에 해당하는 각 API 서버의 엔드포인트를 단일화하여 클라이언트의 요청을 처리할 적합한 서비스로 라우팅
>> 3. Circuit Breaker : 특정 서비스에서의 장애가 다른 서비스로 전파되지 않도록 함
>> 4. Message Queue : 서비스간의 통신은 비동기로 구현하여 서비스 간 통신으로 인한 의존성이 발생하지 않도록 한다.

> 서비스 디스커버리(Service Discovery)
>> MSA 서비스는 각각 별개의 네트워크 위치 정보(IP, Port)를 갖는다. 이 서비스의 정보는 클라우드 환경에서 동적으로 바뀔 수 있고, 예기치 못한 장애로 인해 특정 네트워크 위치 정보의 서비스는 이용 불가능할 수 있다.
>> 따라서 분산 서비스에서는 1.서비스의 네트워크 위치 정보를 관리하고 2.가용 상태를 확인해줄 수 있는 기능이 필요한데 해결책으로 제시될 수 있는 디자인 패턴이 서비스 디스커버리다

>>클라이언트 사이드 디스커버리 : 서비스의 위치 정보와 사용 상태를 관리할 수 있는 서비스 레지스트리를 두고, 클라이언트가 서비스 레지스트리에게 가용 상태에 있는 서비스의 네트워크 위치 정보를 질의하게 함으로써 구현
>>서버 사이드 디스커버리 : 클라이언트와 서비스 레지스트리 사이에 로드밸런서를 위치시켜 로드밸런서가 클라이언트 대신 서비스 레지스트리에 질의하여 서비스를 호출. 클라이언트가 서비스레지스트리에 직접 질의해야 하는 구조에서 발생하는 의존성을 제거할 수 있다.

> Netflix Eureka
>> 서비스 디스커버리 패턴 구현 가능. Eureka 서버(서비스 레지스트리)와 Eureka 클라이언트로 구성되어 있다.
 
> 주석
>> application.yml
>>>eureka.client.register-with-eureka : Eureka 서버에 클라이언트로 등록 여부
eureka.client.fetch-registry : Eureka 서버로부터 받은 서비스 리스트에 대한 캐싱 여부
> >>eureka.instance.instance-id : 동일한 서비스내에서 인스턴스를 식별하기 위한 ID
eureka.client.service-url.defaultZone : Eureka 클라이언트가 속할 Zone 정의
> 
>>> localhost:8761 로 접속하여 Eureka 대시보드 확인 가능
> 